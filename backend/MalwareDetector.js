const Utils = require("./Utils");

class MalwareDetector {
    constructor(socket, EmailSender) {
        this.socket = socket;
        this.EmailSender = EmailSender;
    }

    async malwareDetected(threatType, maliciousInput, attacker) {
        attacker = attacker === "" ? "Unknown" : attacker;
        const threatMessage = `${threatType} Attack Detected! Attacker: ${attacker}, Malicious Input: ${maliciousInput}\n`;
        Utils.writeToLogFile('../guardianvault/threats_log.txt', threatMessage);
        await this.EmailSender.sendAdminThreatAlert(threatType, attacker);
    }
    
}

module.exports = { MalwareDetector };
