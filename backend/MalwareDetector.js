const Utils = require("./Utils");

class MalwareDetector
{
    constructor(socket)
    {
        this.socket = socket;
    }

    malwareDetected(threatType, maliciousInput, attacker) {
        attacker = attacker === "" ? "Unknown" : attacker;
        const threatMessage = `${threatType} Attack Detected! Attacker: ${attacker}, Malicious Input: ${maliciousInput}\n`;
        Utils.writeToLogFile('../guardianvault/threats_log.txt', threatMessage);
    }
}

module.exports = {MalwareDetector};